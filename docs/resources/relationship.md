---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "ory_relationship Resource - ory"
subcategory: ""
description: |-
  Manages an Ory Keto relationship tuple for fine-grained authorization.
---

# ory_relationship (Resource)

Manages an Ory Keto relationship tuple for fine-grained authorization.

Relationships are the foundation of Ory Permissions (Keto), which implements [Google's Zanzibar](https://research.google/pubs/pub48190/) authorization model. They define who (subject) has what relation to which resource (object) in a namespace.

## Prerequisites

~> **Important:** You must configure Keto namespaces via `ory_project_config` **before** creating relationships. If the namespace doesn't exist, the API will return a 404 error.

```terraform
resource "ory_project_config" "main" {
  keto_namespaces = ["documents", "folders", "groups"]
}

resource "ory_relationship" "example" {
  namespace  = "documents"
  object     = "doc-123"
  relation   = "viewer"
  subject_id = "user-456"

  depends_on = [ory_project_config.main]
}
```

## Relationship Tuple Structure

A relationship tuple consists of:
- **namespace**: The type of resource (e.g., `documents`, `folders`) â€” must be configured in `keto_namespaces`
- **object**: The specific resource ID
- **relation**: The type of relationship (e.g., `viewer`, `editor`, `owner`)
- **subject**: Either a user ID (`subject_id`) or another relationship tuple (`subject_set_*`)

## Example Usage

### Simple User Permission

```terraform
# user-456 can view doc-123
resource "ory_relationship" "user_can_view" {
  namespace  = "documents"
  object     = "doc-123"
  relation   = "viewer"
  subject_id = "user-456"
}
```

### Subject Set (Inherited Permission)

Grant all editors of a folder access to view documents in that folder:

```terraform
resource "ory_relationship" "editors_can_view" {
  namespace             = "documents"
  object                = "doc-123"
  relation              = "viewer"
  subject_set_namespace = "folders"
  subject_set_object    = "folder-789"
  subject_set_relation  = "editor"
}
```

This means: anyone who is an `editor` of `folder-789` in the `folders` namespace is automatically a `viewer` of `doc-123` in the `documents` namespace.

### Complete RBAC Example

```terraform
resource "ory_project_config" "main" {
  keto_namespaces = ["documents", "groups"]
}

# User is member of a group
resource "ory_relationship" "user_in_group" {
  namespace  = "groups"
  object     = "engineering"
  relation   = "member"
  subject_id = "user-alice"

  depends_on = [ory_project_config.main]
}

# Group members can edit project (via subject set)
resource "ory_relationship" "group_edit_project" {
  namespace             = "documents"
  object                = "project-abc"
  relation              = "editor"
  subject_set_namespace = "groups"
  subject_set_object    = "engineering"
  subject_set_relation  = "member"

  depends_on = [ory_project_config.main]
}
```

## Important Behaviors

- **Relationships are immutable.** Any change to any field forces a new resource (destroy + create).
- **`subject_id` and `subject_set_*` are mutually exclusive.** You must provide either `subject_id` (for a direct user) or all three `subject_set_*` attributes (for an inherited permission), but not both.
- **All three `subject_set_*` fields must be set together.** Setting only `subject_set_namespace` without `subject_set_object` and `subject_set_relation` will produce an error.

## Import

Import using Zanzibar-style tuple notation:

```shell
# Simple subject (user ID)
terraform import ory_relationship.example "namespace:object#relation@subject_id"

# Subject set (inherited permission)
terraform import ory_relationship.example "namespace:object#relation@subject_namespace:subject_object#subject_relation"
```

### Examples

```shell
# user-456 is a viewer of doc-123 in documents namespace
terraform import ory_relationship.user_can_view "documents:doc-123#viewer@user-456"

# editors of folder-789 are viewers of doc-123
terraform import ory_relationship.editors_can_view "documents:doc-123#viewer@folders:folder-789#editor"
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `namespace` (String) The namespace of the relationship (e.g., `documents`, `folders`). Must be configured in `ory_project_config.keto_namespaces`. **Cannot be changed after creation.**
- `object` (String) The object ID in the namespace. **Cannot be changed after creation.**
- `relation` (String) The relation type (e.g., `viewer`, `editor`, `owner`). **Cannot be changed after creation.**

### Optional

- `subject_id` (String) The subject ID (user ID). Mutually exclusive with `subject_set_*` attributes. **Cannot be changed after creation.**
- `subject_set_namespace` (String) The namespace for a subject set. Must be used with `subject_set_object` and `subject_set_relation`. **Cannot be changed after creation.**
- `subject_set_object` (String) The object ID for a subject set. **Cannot be changed after creation.**
- `subject_set_relation` (String) The relation for a subject set. **Cannot be changed after creation.**

### Read-Only

- `id` (String) Composite ID in Zanzibar tuple format: `namespace:object#relation@subject`.
