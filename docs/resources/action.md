---
page_title: "ory_action Resource - ory"
subcategory: ""
description: |-
  Manages an Ory Action (webhook) for identity flows.
---

# ory_action (Resource)

Manages an Ory Action (webhook) for identity flows.

Actions allow you to trigger webhooks at specific points in identity flows (login, registration, recovery, settings, verification).

## Example Usage

```terraform
# Post-registration webhook
resource "ory_action" "welcome_email" {
  flow        = "registration"
  timing      = "after"
  auth_method = "password"
  url         = "https://api.example.com/webhooks/welcome"
  method      = "POST"
  body        = <<-JSONNET
    function(ctx) {
      email: ctx.identity.traits.email,
      name: ctx.identity.traits.name,
      created_at: ctx.identity.created_at
    }
  JSONNET
}

# Pre-login validation
resource "ory_action" "validate_login" {
  flow          = "login"
  timing        = "before"
  url           = "https://api.example.com/webhooks/validate"
  method        = "POST"
  can_interrupt = true # Allow webhook to block login
}

# Async audit log (fire and forget)
resource "ory_action" "audit_log" {
  flow            = "settings"
  timing          = "after"
  auth_method     = "password"
  url             = "https://api.example.com/webhooks/audit"
  method          = "POST"
  response_ignore = true
}

# Post-verification sync
resource "ory_action" "sync_verified" {
  flow        = "verification"
  timing      = "after"
  auth_method = "code"
  url         = "https://api.example.com/webhooks/user-verified"
  method      = "POST"
}
```

## Authentication Methods

The `auth_method` attribute specifies which authentication method triggers the webhook. This is only used for `timing = "after"` webhooks.

| Value | Description |
|-------|-------------|
| `password` | Password-based authentication (default) |
| `oidc` | Social/OIDC authentication (Google, GitHub, etc.) |
| `code` | One-time code (magic link, OTP) |
| `webauthn` | Hardware security keys |
| `passkey` | Passkey authentication |
| `totp` | Time-based one-time password |
| `lookup_secret` | Recovery/backup codes |

~> **Note:** `auth_method` is only used for `timing = "after"` webhooks. For `timing = "before"` hooks, the webhook runs before any authentication method is invoked.

## HTTP Method

The `method` attribute specifies the HTTP method used when calling the webhook:

| Value | Description |
|-------|-------------|
| `POST` | HTTP POST request (default) |
| `GET` | HTTP GET request |
| `PUT` | HTTP PUT request |
| `PATCH` | HTTP PATCH request |
| `DELETE` | HTTP DELETE request |

## Import

Actions must be imported with the HTTP method included in the import ID.

**For "after" timing (post-hooks):**
```shell
terraform import ory_action.example "project_id:flow:after:auth_method:method:url"
```

**For "before" timing (pre-hooks):**
```shell
terraform import ory_action.example "project_id:flow:before:method:url"
```

### Examples

```shell
# Import a POST webhook for post-registration password flow
terraform import ory_action.welcome \
  "550e8400-e29b-41d4-a716-446655440000:registration:after:password:POST:https://api.example.com/webhooks/welcome"

# Import a PATCH webhook for post-login social (OIDC) flow
terraform import ory_action.social_login \
  "550e8400-e29b-41d4-a716-446655440000:login:after:oidc:PATCH:https://api.example.com/webhooks/social"

# Import a POST pre-login validation webhook
terraform import ory_action.validate \
  "550e8400-e29b-41d4-a716-446655440000:login:before:POST:https://api.example.com/webhooks/validate"
```

### Finding Import Values from Ory Console

1. **project_id**: Settings → General → Project ID
2. **flow**: The flow type (login, registration, recovery, settings, verification)
3. **timing**: "before" or "after"
4. **auth_method** (for "after" only): password, oidc, code, webauthn, passkey, totp, lookup_secret
5. **method**: The HTTP method (POST, GET, PUT, PATCH, DELETE)
6. **url**: The exact webhook URL - must match exactly including protocol and trailing slashes

### Troubleshooting Import Errors

If you see "Cannot import non-existent remote object", the import will show a warning listing webhooks found at that location. This helps you find the correct URL, method, and auth_method.

Common issues:
- **URL mismatch**: URLs must match exactly, including `https://` and any trailing `/`
- **Wrong method**: Check the HTTP method configured for the webhook (POST, PATCH, etc.)
- **Wrong auth_method**: Check which authentication method the webhook is configured for
- **Wrong timing**: Check if the webhook is a pre-hook (before) or post-hook (after)

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `flow` (String) Identity flow to hook into (login, registration, recovery, settings, verification).
- `timing` (String) When to trigger: 'before' (pre-hook) or 'after' (post-hook).
- `url` (String) Webhook URL to call. Must match exactly, including protocol (`https://`) and any trailing slashes. **Cannot be changed after creation** - changing this will force a new resource.

### Optional

- `auth_method` (String) Authentication method that triggers the webhook. In the Ory Console UI, this is the "Method" selector. Valid values: `password` (default), `oidc` (social login), `code` (magic link/OTP), `webauthn`, `passkey`, `totp`, `lookup_secret`. Only used for `timing = "after"` webhooks.
- `body` (String) [Jsonnet](https://jsonnet.org/) template for the request body. This is NOT plain JSON - it is a Jsonnet expression that receives a `ctx` parameter with flow context. The provider handles base64 encoding internally.
- `can_interrupt` (Boolean) Allow webhook to interrupt/block the flow (default: false).
- `method` (String) HTTP method (default: POST).
- `project_id` (String) Project ID. If not set, uses provider's project_id.
- `response_ignore` (Boolean) Run webhook async without waiting (default: false).
- `response_parse` (Boolean) Parse response to modify identity (default: false).

### Read-Only

- `id` (String) Composite resource ID in the format `project_id:flow:timing:auth_method:url`.
