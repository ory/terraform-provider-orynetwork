---
page_title: "ory_identity Resource - ory"
subcategory: ""
description: |-
  Manages an Ory Network identity (user).
---

# ory_identity (Resource)

Manages an Ory Network identity (user).

Identities represent users in your application. Each identity has traits (profile data) defined by an identity schema.

## Required Provider Configuration

This resource requires the following provider configuration:

```hcl
provider "ory" {
  project_api_key = var.ory_project_api_key  # or ORY_PROJECT_API_KEY env var
  project_slug    = var.ory_project_slug     # or ORY_PROJECT_SLUG env var
}
```

Or via environment variables:

```bash
export ORY_PROJECT_API_KEY="ory_pat_..."
export ORY_PROJECT_SLUG="your-project-slug"
```

## Schema ID

The `schema_id` attribute specifies which identity schema defines the structure of the identity's traits.

~> **Important:** The value of `schema_id` must match a schema that exists in your project. Using a schema ID that doesn't exist (including `"default"` on projects that don't have a schema named "default") will result in an HTTP 500 error.

**How to find your project's schema IDs:**

1. **Ory Console:** Go to your project > Identity Schema to see configured schemas
2. **API:** `GET /projects/<project-id>` and check `services.identity.config.identity.schemas`
3. **Terraform:** Use `ory_identity_schema` resources and reference their IDs

**Common schema ID values:**

| Schema ID | Description |
|-----------|-------------|
| `preset://email` | Built-in email schema (most common default for new projects) |
| `preset://username` | Built-in username schema |
| `default` | Only valid if your project has a schema explicitly named "default" |
| Custom IDs | e.g., `customer_v1` - if created via `ory_identity_schema` or Console |

**Example: Check which schemas exist before creating identities:**

```hcl
# If your project uses the preset://email schema:
resource "ory_identity" "user" {
  schema_id = "preset://email"
  traits = jsonencode({
    email = "user@example.com"
  })
}

# Or reference a Terraform-managed schema:
resource "ory_identity" "customer" {
  schema_id = ory_identity_schema.customer.id
  traits = jsonencode({
    email = "customer@example.com"
  })
}
```

## Important Behaviors

- **Password is write-only:** The `password` attribute is not returned on read and cannot be imported. It is only used during creation and updates.
- **External deletion detection:** If an identity is deleted outside of Terraform (via UI or API), the next `terraform plan` will detect the 404 and remove it from state automatically.
- **Traits must match schema:** The JSON structure of `traits` must match the identity schema definition. Mismatched traits will cause API errors.
- **Metadata visibility:** `metadata_public` is visible to the identity owner. `metadata_admin` is only visible via the admin API and is marked sensitive in Terraform.

## Example Usage

```terraform
# Identity using a preset schema
resource "ory_identity" "basic_user" {
  schema_id = "preset://email"
  traits = jsonencode({
    email = "user@example.com"
  })
}

# Identity with password and metadata
resource "ory_identity" "user_with_password" {
  schema_id = "preset://email"
  traits = jsonencode({
    email = "secure-user@example.com"
  })
  password = var.user_password
  state    = "active"

  metadata_public = jsonencode({
    role = "user"
  })
}

# Identity with custom schema and metadata
resource "ory_identity" "customer" {
  schema_id = ory_identity_schema.customer.id
  traits = jsonencode({
    email = "customer@example.com"
    name = {
      first = "John"
      last  = "Doe"
    }
  })
  metadata_public = jsonencode({
    tier = "premium"
  })
  metadata_admin = jsonencode({
    internal_id = "cust-12345"
  })
}

variable "user_password" {
  type      = string
  sensitive = true
}
```

## Import

Identities can be imported using their ID:

```shell
terraform import ory_identity.user <identity-id>
```

~> **Note:** When importing, `password` will not be available (it is write-only and never returned by the API).

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `traits` (String) Identity traits as JSON string. The structure must match your identity schema definition. Use `jsonencode()` to convert HCL to JSON.

### Optional

- `metadata_admin` (String, Sensitive) Admin metadata as JSON string. Only visible via the admin API, not to the identity owner.
- `metadata_public` (String) Public metadata as JSON string. Visible to the identity owner.
- `password` (String, Sensitive) Password for the identity. Write-only: not returned on read and cannot be imported.
- `schema_id` (String) Identity schema ID. Must match a schema configured in your project (e.g., `preset://email`, `customer_v1`, or a Terraform-managed schema reference). **Defaults to `"default"`** â€” this causes an HTTP 500 error on projects using preset schemas. Always set this explicitly.
- `state` (String) Identity state: `active` or `inactive`. Defaults to `active`.

### Read-Only

- `id` (String) The unique identifier of the identity.
